"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{3938:(e,r,t)=>{t.r(r),t.d(r,{default:()=>n});var a=t(5155),s=t(7013),o=t(8232),l=t(2115);let n=()=>{let{getUsers:e}=(0,l.useContext)(s.t),{planes:r}=(0,l.useContext)(o.a),[t,n]=(0,l.useState)([]),[i,c]=(0,l.useState)(""),[u,d]=(0,l.useState)([]),[g,m]=(0,l.useState)(null),[p,h]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let r=await e();n(r)}catch(e){console.error("Error fetching users:",e)}})()},[e]);let f=t.filter(e=>{let r=e.name.toLowerCase().includes(i.toLowerCase())||e.email.toLowerCase().includes(i.toLowerCase())||e.id.toLowerCase().includes(i.toLowerCase()),t=!0;return u.length>0&&(t=!!(e.subscripcion&&e.subscripcion.plan&&u.includes(e.subscripcion.plan.id))),r&&t}),b=e=>{u.includes(e)?d(r=>r.filter(r=>r!==e)):d(r=>[...r,e])},w=e=>{m(e),h(!0)};return(0,a.jsxs)("section",{className:"px-4 py-3 mx-auto max-w-7xl",children:[(0,a.jsx)("h1",{className:"mb-4 text-3xl font-bold",children:"Panel de Administraci\xf3n"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-6 md:flex-row",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar por username, email o ID...",value:i,onChange:e=>c(e.target.value),className:"flex-1 px-4 py-2 text-white bg-gray-700 rounded-lg"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-4",children:r.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>b(e.id),className:"px-4 py-2 rounded-lg text-white cursor-pointer transition-colors ".concat(u.includes(e.id)?"bg-indigo-600":"bg-gray-700"),children:e.name},e.id))})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:f.length>0?f.map(e=>(0,a.jsxs)("div",{onClick:()=>w(e),className:"relative p-4 transition-colors bg-gray-700 rounded-lg shadow cursor-pointer hover:bg-gray-600",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-white",children:e.name}),e.isAdmin&&(0,a.jsx)("div",{className:"absolute flex items-center justify-center w-4 h-4 text-xs font-bold rounded-full top-2 right-2 bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-400 text-neutral-950",children:"A"}),(0,a.jsx)("p",{className:"text-gray-300",children:e.email}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:["ID: ",e.id]})]},e.id)):(0,a.jsx)("div",{className:"text-center text-gray-300 col-span-full",children:"No se encontraron usuarios."})}),p&&g&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"w-11/12 p-6 bg-gray-800 rounded-lg shadow-lg md:w-1/2 lg:w-1/3",style:{transform:"scaleX(1.2) scaleY(1.1)",transformOrigin:"center"},children:[(0,a.jsx)("h2",{className:"mb-4 text-2xl font-bold text-white",children:"Detalles del Usuario"}),(0,a.jsx)("div",{className:"space-y-2 text-gray-300",children:Object.entries(g).filter(e=>{let[r]=e;return"password"!==r&&"isAdmin"!==r}).map(e=>{let[r,t]=e;return(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("span",{className:"mr-2 font-bold",children:[r,":"]}),(0,a.jsx)("span",{children:"object"==typeof t?JSON.stringify(t):t})]},r)})}),(0,a.jsx)("button",{onClick:()=>{m(null),h(!1)},className:"px-4 py-2 mt-4 text-white transition-all rounded bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700",children:"Cerrar"})]})})]})}},3932:(e,r,t)=>{t.d(r,{A:()=>s});let a=t(2651).A.create({baseURL:"https://assetly-landing-page-backend.onrender.com/",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let r=localStorage.getItem("token");r&&(e.headers.Authorization="Bearer ".concat(r))}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>Promise.reject(e));let s=a},7013:(e,r,t)=>{t.d(r,{X:()=>i,t:()=>n});var a=t(5155),s=t(2115),o=t(3932),l=t(2155);let n=(0,s.createContext)({getUsers:async()=>{throw Error("Not implemented")},getUsersSubscribed:async()=>{throw Error("Not implemented")},getUsersSubscribedAt:async e=>{throw Error("Not implemented")}}),i=e=>{let{children:r}=e,t=async()=>{let e=localStorage.getItem("admin_users");if(e)return console.log("Cargando usuarios desde localStorage..."),JSON.parse(e);let{data:r,error:t}=await (0,l.$)(o.A.get("/users/users"));if(t||!r)throw Error(t.message||"Hubo un error al iniciar sesi\xf3n.");return localStorage.setItem("admin_users",JSON.stringify(r.data)),r.data},s=async()=>{let e=localStorage.getItem("admin_usersSubscribed");if(e)return console.log("Cargando usuarios suscritos desde localStorage..."),JSON.parse(e);let{data:r,error:t}=await (0,l.$)(o.A.get("/users/getUsersSubscribed"));if(t||!r)throw Error(t.message||"Hubo un error al iniciar sesi\xf3n.");return localStorage.setItem("admin_usersSubscribed",JSON.stringify(r.data)),r.data},i=async e=>{let r="admin_usersSubscribed_plan_".concat(e),t=localStorage.getItem(r);if(t)return console.log("Cargando usuarios suscritos al plan ".concat(e," desde localStorage...")),JSON.parse(t);let{data:a,error:s}=await (0,l.$)(o.A.get("/users/getUsersSubscribed/".concat(e)));if(s||!a)throw Error(s.message||"Hubo un error al iniciar sesi\xf3n.");return localStorage.setItem(r,JSON.stringify(a.data)),a.data};return(0,a.jsx)(n.Provider,{value:{getUsers:t,getUsersSubscribed:s,getUsersSubscribedAt:i},children:r})}},8232:(e,r,t)=>{t.d(r,{a:()=>c,g:()=>u});var a=t(5155),s=t(2115),o=t(4357),l=t(3932),n=t(2155),i=t(1455);let c=(0,s.createContext)({sub:null,planes:[],viewPlan:null,suscribirse:async()=>{},desuscribirse:async()=>{},selectPlan:async()=>null,changePlan:()=>{}}),u=e=>{let{children:r}=e,{user:t}=(0,s.useContext)(i.R),[u,d]=(0,s.useState)(null),[g,m]=(0,s.useState)([]),[p,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{(0,o.Lz)("TEST-450aba78-55dc-4623-9975-99be4b21f666")},[]);let f=(0,s.useCallback)(async()=>{try{let e=localStorage.getItem("planes");if(e){let r=JSON.parse(e);m(r),console.log("Planes cargados desde LocalStorage");return}let{data:r,error:t}=await (0,n.$)(l.A.get("/users/planes"));if(t||!(null==r?void 0:r.data)){console.error("Error al obtener planes:",t||"No se retornaron datos");return}let a=r.data;m(a),localStorage.setItem("planes",JSON.stringify(a))}catch(e){console.error("Error en getPlanes:",e)}},[]),b=(0,s.useCallback)(async(e,r)=>{try{var a;let{data:s,error:o}=await (0,n.$)(l.A.post("/subscriptions",{planId:e,userEmail:null==t?void 0:t.email,paymentMethodToken:r}));if(o||!(null==s?void 0:null===(a=s.data)||void 0===a?void 0:a.subscription)){console.error("Error al suscribirse:",o||"No se retornaron datos");return}let i=s.data.subscription;d(i),localStorage.setItem("subscripcion",JSON.stringify(i))}catch(e){console.error("Excepci\xf3n en suscribirse:",e)}},[t]),w=(0,s.useCallback)(async()=>{if(u)try{var e;let{data:r,error:t}=await (0,n.$)(l.A.post("/subscriptions/cancel",{subscriptionId:u.mercadopagoSubscriptionId,cancellationReason:"Cancelaci\xf3n solicitada por el usuario"}));if(t||!(null==r?void 0:null===(e=r.data)||void 0===e?void 0:e.subscription)){console.error("Error al desuscribirse:",t||"No se retornaron datos");return}d(null),localStorage.removeItem("subscripcion")}catch(e){console.error("Excepci\xf3n en desuscribirse:",e)}},[u]),y=(0,s.useCallback)(async e=>{0===g.length&&await f();let r=g.find(r=>r.id===e);return r?(h(r),localStorage.setItem("viewPlan",JSON.stringify(r)),r):(console.error("Plan no encontrado"),null)},[g,f]),S=(0,s.useCallback)(e=>{if(!p||0===g.length)return;let r=g.findIndex(e=>e.id===p.id);if(-1===r)return;let t="next"===e?r+1:r-1;t<0&&(t=g.length-1),t>=g.length&&(t=0);let a=g[t];h(a),localStorage.setItem("viewPlan",JSON.stringify(a))},[g,p]);(0,s.useEffect)(()=>{let e=localStorage.getItem("subscripcion");e&&d(JSON.parse(e)),f()},[t,f]),(0,s.useEffect)(()=>{if(g.length>0&&!p){let e=localStorage.getItem("viewPlan");e?h(JSON.parse(e)):h(g.find(e=>!0===e.popular)||g[0])}},[g,p]);let x=(0,s.useMemo)(()=>({sub:u,planes:g,viewPlan:p,suscribirse:b,desuscribirse:w,selectPlan:y,changePlan:S}),[u,g,p,b,w,y,S]);return(0,a.jsx)(c.Provider,{value:x,children:r})}},1455:(e,r,t)=>{t.d(r,{R:()=>i,v:()=>c});var a=t(5155),s=t(2115),o=t(3932),l=t(2155),n=t(2615);let i=(0,s.createContext)({token:"",user:null,signInO:async()=>{throw Error("Not implemented")},signUp:async()=>{throw Error("Not implemented")},deleteUser:async()=>{throw Error("Not implemented")},mailIsValid:async()=>{throw Error("Not implemented")},updateUser:async()=>{throw Error("Not implemented")},signOut:()=>{throw Error("Not implemented")},signInWithGoogle:async()=>{throw Error("Not implemented")},signUpWithGoogle:async()=>{throw Error("Not implemented")},requestResetPassword:async()=>{throw Error("Not implemented")},resetPassword:async()=>{throw Error("Not implemented")}}),c=e=>{let{children:r}=e,{data:t}=(0,n.useSession)(),[c,u]=(0,s.useState)(null),[d,g]=(0,s.useState)(""),[m,p]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(m)return;let e=localStorage.getItem("token"),r=localStorage.getItem("user");if(e&&g(e),r)try{u(JSON.parse(r))}catch(e){console.error("Error al parsear el usuario del localStorage",e)}if(null==t?void 0:t.user){let{email:e,name:r}=t.user;h(e,r)}},[t,m]);let h=async(e,r)=>{try{let{data:t,error:a}=await (0,l.$)(o.A.get("users/email/get/".concat(e)));if(a)return console.warn("Error al consultar existencia del usuario:",a.message),null;if(null==t?void 0:t.data){let{data:r,error:t}=await (0,l.$)(o.A.get("/users/get/".concat(e)));if(t||!r)return console.log("Error al traer el usuario:",null==t?void 0:t.message),null;return u(r.data.User),g(r.data.token),localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data)),r.data}let{data:s,error:n}=await (0,l.$)(o.A.post("/users/crearUser/google",{email:e,name:r}));if(n||!s)return console.log("Error al crear el usuario:",null==n?void 0:n.message),null;return u(s.data),localStorage.setItem("user",JSON.stringify(s.data)),s.data}catch(e){return console.error("Error en el proceso de registro:",e),null}},f=async e=>{let{data:r,error:t}=await (0,l.$)(o.A.post("/users/signIn",e));if(t||!r)throw Error(t.message||"Hubo un error al iniciar sesi\xf3n.");let{User:a,token:s}=(null==r?void 0:r.data)||{};if(!a||!s)throw Error("Los datos de autenticaci\xf3n son inv\xe1lidos.");return g(s),u(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},b=async e=>{let{data:r,error:t}=await (0,l.$)(o.A.post("/users/signUp",e));if(t||!r)throw Error(t.message||"Hubo un error al registrarse.");let{User:a,token:s}=r.data;return g(s),u(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},w=async e=>{let{data:r,error:t}=await (0,l.$)(o.A.delete("/users/user",{data:e}));if(t||!r)throw Error(t.message||"Hubo un error al eliminar el usuario.");let a=r.data;return g(""),u(null),localStorage.removeItem("token"),localStorage.removeItem("user"),a},y=async e=>{try{return(await o.A.get("/users/email/".concat(e))).data}catch(e){return!1}},S=async e=>{if(!(null==c?void 0:c.id))throw Error("El usuario no est\xe1 autenticado.");let{data:r,error:t}=await (0,l.$)(o.A.post("/users/update",{...e,id:c.id}));if(t||!r)throw Error(t.message||"Hubo un error al actualizar el usuario.");let{User:a,token:s}=r.data;return g(s),u(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},x=async()=>{await (0,n.signOut)({redirect:!1}),g(""),u(null),localStorage.removeItem("token"),localStorage.removeItem("user"),p(!0)},N=async()=>{try{await (0,n.signIn)("google",{callbackUrl:"/"});let e=await (0,n.getSession)();if(!e||!e.user)throw Error("No se pudo obtener la sesi\xf3n del usuario.");let{email:r,name:t}=e.user;return h(r,t)}catch(e){return console.error("Error en signInWithGoogle:",e),null}},v=async()=>{try{await (0,n.signIn)("google",{callbackUrl:"/"});let e=await (0,n.getSession)();if(!e||!e.user)throw Error("No se pudo obtener la sesi\xf3n del usuario.");let{email:r,name:t}=e.user;return h(r,t)}catch(e){return console.error("Error en signUpWithGoogle:",e),null}},E=async e=>{let{data:r,error:t}=await (0,l.$)(o.A.post("/users/request-reset-password",{email:e}));if(t||!r)throw Error(t.message||"Error al solicitar reset de contrase\xf1a");return r.data},I=async(e,r)=>{let{data:t,error:a}=await (0,l.$)(o.A.post("/users/reset-password",{token:e,newPassword:r}));if(a||!t)throw Error(a.message||"Error al resetear la contrase\xf1a");return t.data};return(0,a.jsx)(i.Provider,{value:{token:d,user:c,signInO:f,signUp:b,deleteUser:w,mailIsValid:y,updateUser:S,signOut:x,signInWithGoogle:N,signUpWithGoogle:v,requestResetPassword:E,resetPassword:I},children:r})}},2155:(e,r,t)=>{t.d(r,{$:()=>a});let a=async e=>{try{return{data:await e}}catch(e){return console.error("Error en handleAsync:",e),{error:e.response?e.response.data:{message:e.message}}}}}}]);