"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[322],{322:(e,r,t)=>{t.r(r),t.d(r,{default:()=>m});var a=t(5155),s=t(2115),l=t(1455),o=t(4057);let n=(0,o.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),i=(0,o.A)("UserPen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);var c=t(6046),d=t(8173),u=t.n(d);let m=()=>{let{user:e,updateUser:r,signOut:t}=(0,s.useContext)(l.R),o=(0,c.useRouter)(),[d,m]=(0,s.useState)({email:"",company:"",password:"",telefono:"",name:""}),[g,p]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{let r;return e?m({name:e.name||"",email:e.email||"",telefono:e.telefono||"",company:e.company||"",password:""}):r=setTimeout(()=>{null==o||o.push("/signin")},1e3),()=>{clearTimeout(r)}},[e,o]),!e)return null;let h=e=>{m({...d,[e.target.name]:e.target.value})},x=async t=>{t.preventDefault(),await r({...d,id:e.id}),p(!1)},y=()=>{p(!g)};return(0,a.jsx)("section",{className:"px-2 py-3 mx-auto max-w-7xl",children:(0,a.jsxs)("div",{className:"relative w-[75vw] mx-auto overflow-hidden bg-gray-800 shadow-2xl sm:px-6 rounded-2xl flex flex-col",children:[(0,a.jsxs)("div",{className:"relative flex flex-wrap items-center justify-between gap-3 px-4 py-6 md:flex-row",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(u(),{href:"/",onClick:()=>{t()},className:"transition-transform transform hover:scale-110",children:(0,a.jsx)(n,{size:48,className:"text-red-400"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("h2",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-indigo-200/65",children:e.id})]})]}),(0,a.jsx)("p",{className:"w-full text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 md:text-right md:w-auto",children:e.company})]}),(null==e?void 0:e.isAdmin)&&(0,a.jsx)("div",{className:"absolute top-0 right-0 px-3 py-1 text-lg rounded-l-lg bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-400 text-neutral-950",children:"Admin"}),(0,a.jsx)("div",{className:"p-4",children:g?(0,a.jsxs)("form",{onSubmit:x,children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300",children:"Nombre"}),(0,a.jsx)("input",{type:"text",name:"name",value:d.name,onChange:h,className:"w-full px-3 py-2 mt-1 text-white bg-gray-700 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300",children:"Email"}),(0,a.jsx)("input",{type:"email",name:"email",value:d.email,onChange:h,className:"w-full px-3 py-2 mt-1 text-white bg-gray-700 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300",children:"Tel\xe9fono"}),(0,a.jsx)("input",{type:"text",name:"telefono",value:d.telefono,onChange:h,className:"w-full px-3 py-2 mt-1 text-white bg-gray-700 rounded-lg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300",children:"Empresa"}),(0,a.jsx)("input",{type:"text",name:"company",value:d.company,onChange:h,className:"w-full px-3 py-2 mt-1 text-white bg-gray-700 rounded-lg"})]})]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("label",{className:"block text-gray-300",children:"Contrase\xf1a (dejar en blanco para no cambiar)"}),(0,a.jsx)("input",{type:"password",name:"password",value:d.password,onChange:h,className:"w-full px-3 py-2 mt-1 text-white bg-gray-700 rounded-lg",placeholder:"********"})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,a.jsx)("button",{type:"submit",className:"px-6 py-3 font-semibold text-white transition-transform transform rounded-lg shadow-md hover:scale-110 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700",children:"Guardar Cambios"}),(0,a.jsx)("button",{type:"button",onClick:y,className:"px-4 py-2 text-white transition-transform transform bg-gray-600 rounded-lg hover:bg-gray-700 hover:scale-110",children:"Cancelar"})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"block text-gray-300",children:[(0,a.jsx)("strong",{children:"Nombre:"})," ",d.name]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"block text-gray-300",children:[(0,a.jsx)("strong",{children:"Email:"})," ",d.email]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"block text-gray-300",children:[(0,a.jsx)("strong",{children:"Tel\xe9fono:"})," ",d.telefono]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"block text-gray-300",children:[(0,a.jsx)("strong",{children:"Empresa:"})," ",d.company]})})]}),(0,a.jsx)("div",{className:"flex justify-end mt-4",children:(0,a.jsx)("button",{onClick:y,className:"transition-transform transform text-indigo-200/65 hover:scale-110",children:(0,a.jsx)(i,{size:35})})})]})})]})})}},3932:(e,r,t)=>{t.d(r,{A:()=>s});let a=t(2651).A.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let r=localStorage.getItem("token");r&&(e.headers.Authorization="Bearer ".concat(r))}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>Promise.reject(e));let s=a},1455:(e,r,t)=>{t.d(r,{R:()=>i,v:()=>c});var a=t(5155),s=t(2115),l=t(3932),o=t(2155),n=t(2615);let i=(0,s.createContext)({token:"",user:null,signInO:async()=>{throw Error("Not implemented")},signUp:async()=>{throw Error("Not implemented")},deleteUser:async()=>{throw Error("Not implemented")},mailIsValid:async()=>{throw Error("Not implemented")},updateUser:async()=>{throw Error("Not implemented")},signOut:async()=>{throw Error("Not implemented")},signInWithGoogle:async()=>{throw Error("Not implemented")},signUpWithGoogle:async()=>{throw Error("Not implemented")},requestResetPassword:async()=>{throw Error("Not implemented")},resetPassword:async()=>{throw Error("Not implemented")}}),c=e=>{let{children:r}=e,{data:t}=(0,n.useSession)(),[c,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(""),[g,p]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(g)return;let e=localStorage.getItem("token"),r=localStorage.getItem("user");if(e&&m(e),r)try{d(JSON.parse(r))}catch(e){console.error("Error al parsear el usuario del localStorage",e)}if(null==t?void 0:t.user){let{email:e,name:r}=t.user;h(e,r)}},[t,g]);let h=(0,s.useCallback)(async(e,r)=>{try{let{data:t,error:a}=await (0,o.$)(l.A.get("users/email/get/".concat(e)));if(a)return console.warn("Error al consultar existencia del usuario:",a.message),null;if(null==t?void 0:t.data){let{data:r,error:t}=await (0,o.$)(l.A.get("/users/get/".concat(e)));if(t||!r)return console.log("Error al traer el usuario:",null==t?void 0:t.message),null;return d(r.data.User),m(r.data.token),localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data)),r.data}let{data:s,error:n}=await (0,o.$)(l.A.post("/users/crearUser/google",{email:e,name:r}));if(n||!s)return console.log("Error al crear el usuario:",null==n?void 0:n.message),null;return d(s.data),localStorage.setItem("user",JSON.stringify(s.data)),s.data}catch(e){return console.error("Error en el proceso de registro:",e),null}},[]),x=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,o.$)(l.A.post("/users/signIn",e));if(t||!r)throw Error(t.message||"Hubo un error al iniciar sesi\xf3n.");let{User:a,token:s}=(null==r?void 0:r.data)||{};if(!a||!s)throw Error("Los datos de autenticaci\xf3n son inv\xe1lidos.");return m(s),d(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[]),y=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,o.$)(l.A.post("/users/signUp",e));if(t||!r)throw Error(t.message||"Hubo un error al registrarse.");let{User:a,token:s}=r.data;return m(s),d(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[]),f=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,o.$)(l.A.delete("/users/user",{data:e}));if(t||!r)throw Error(t.message||"Hubo un error al eliminar el usuario.");let a=r.data;return m(""),d(null),localStorage.removeItem("token"),localStorage.removeItem("user"),a},[]),w=(0,s.useCallback)(async e=>{try{return(await l.A.get("/users/email/".concat(e))).data}catch(e){return!1}},[]),b=(0,s.useCallback)(async e=>{if(!(null==c?void 0:c.id))throw Error("El usuario no est\xe1 autenticado.");let{data:r,error:t}=await (0,o.$)(l.A.post("/users/update",{...e,id:c.id}));if(t||!r)throw Error(t.message||"Hubo un error al actualizar el usuario.");let{User:a,token:s}=r.data;return m(s),d(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[c]),v=(0,s.useCallback)(async()=>{await (0,n.signOut)({redirect:!1}),m(""),d(null),localStorage.removeItem("token"),localStorage.removeItem("user"),p(!0)},[]),N=(0,s.useCallback)(async()=>{try{await (0,n.signIn)("google",{callbackUrl:"/"});let e=await (0,n.getSession)();if(!e||!e.user)throw Error("No se pudo obtener la sesi\xf3n del usuario.");let{email:r,name:t}=e.user;return h(r,t)}catch(e){return console.error("Error en signInWithGoogle:",e),null}},[h]),j=(0,s.useCallback)(async()=>{try{await (0,n.signIn)("google",{callbackUrl:"/"});let e=await (0,n.getSession)();if(!e||!e.user)throw Error("No se pudo obtener la sesi\xf3n del usuario.");let{email:r,name:t}=e.user;return h(r,t)}catch(e){return console.error("Error en signUpWithGoogle:",e),null}},[h]),k=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,o.$)(l.A.post("/users/request-reset-password",{email:e}));if(t||!r)throw Error(t.message||"Error al solicitar reset de contrase\xf1a");return r.data},[]),E=(0,s.useCallback)(async(e,r)=>{let{data:t,error:a}=await (0,o.$)(l.A.post("/users/reset-password",{token:e,newPassword:r}));if(a||!t)throw Error(a.message||"Error al resetear la contrase\xf1a");return t.data},[]),S=(0,s.useMemo)(()=>({token:u,user:c,signInO:x,signUp:y,deleteUser:f,mailIsValid:w,updateUser:b,signOut:v,signInWithGoogle:N,signUpWithGoogle:j,requestResetPassword:k,resetPassword:E}),[u,c,x,y,f,w,b,v,N,j,k,E]);return(0,a.jsx)(i.Provider,{value:S,children:r})}},6046:(e,r,t)=>{var a=t(6658);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},2155:(e,r,t)=>{t.d(r,{$:()=>a});let a=async e=>{try{return{data:await e}}catch(e){return console.error("Error en handleAsync:",e),{error:e.response?e.response.data:{message:e.message}}}}},4057:(e,r,t)=>{t.d(r,{A:()=>i});var a=t(2115);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:r,...o,width:s,height:s,stroke:t,strokeWidth:i?24*Number(n)/Number(s):n,className:l("lucide",c),...m},[...u.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(d)?d:[d]])}),i=(e,r)=>{let t=(0,a.forwardRef)((t,o)=>{let{className:i,...c}=t;return(0,a.createElement)(n,{ref:o,iconNode:r,className:l("lucide-".concat(s(e)),i),...c})});return t.displayName="".concat(e),t}}}]);