(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{2480:(e,r,t)=>{Promise.resolve().then(t.bind(t,7388))},7388:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var a=t(5155),s=t(8173),o=t.n(s),l=t(2115),n=t(2615),i=t(6046),u=t(1455);function c(){let{signInWithGoogle:e,signInO:r}=(0,l.useContext)(u.R),{data:t}=(0,n.useSession)(),[s,c]=(0,l.useState)(""),[d,m]=(0,l.useState)(""),[g,h]=(0,l.useState)(""),p=(0,i.useRouter)();t&&p.push("/");let w=async e=>{e.preventDefault(),h("");try{r({email:s,password:d}),p.push("/")}catch(e){h(e.message||"Hubo un error al iniciar sesi\xf3n.")}},x=async()=>{await e()};return(0,a.jsx)("section",{children:(0,a.jsx)("div",{className:"max-w-6xl px-4 mx-auto sm:px-6",children:(0,a.jsxs)("div",{className:"py-12 md:py-20",children:[(0,a.jsx)("div",{className:"pb-12 text-center",children:(0,a.jsx)("h1",{className:"animate-[gradient_6s_linear_infinite] bg-[linear-gradient(to_right,theme(colors.gray.200),theme(colors.indigo.200),theme(colors.gray.50),theme(colors.indigo.300),theme(colors.gray.200))] bg-clip-text font-nacelle text-3xl font-semibold text-transparent md:text-4xl",children:"Bienvenido de nuevo"})}),(0,a.jsxs)("form",{onSubmit:w,className:"mx-auto max-w-[400px]",children:[(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block mb-1 text-sm font-medium text-indigo-200/65",children:"Email"}),(0,a.jsx)("input",{id:"email",type:"email",className:"w-full form-input",placeholder:"Su email",value:s,onChange:e=>c(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3 mb-1",children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-indigo-200/65",children:"Contrase\xf1a"}),(0,a.jsx)(o(),{className:"text-sm text-gray-600 hover:underline",href:"/reset-password",children:"\xbfOlvid\xf3 su contrase\xf1a?"})]}),(0,a.jsx)("input",{id:"password",type:"password",className:"w-full form-input",placeholder:"Su contrase\xf1a",value:d,onChange:e=>m(e.target.value)})]})]}),g&&(0,a.jsx)("p",{className:"mt-2 text-sm text-red-500",children:g}),(0,a.jsxs)("div",{className:"mt-6 space-y-5",children:[(0,a.jsx)("button",{type:"submit",className:"btn w-full bg-gradient-to-t from-indigo-600 to-indigo-500 text-white hover:bg-[length:100%_150%]",children:"Logearse"}),(0,a.jsx)("button",{type:"button",onClick:x,className:"w-full mt-2 text-gray-300 btn bg-gradient-to-b from-gray-800 to-gray-800/60",children:"Logearse con Google"})]})]}),(0,a.jsxs)("div",{className:"mt-6 text-sm text-center text-indigo-200/65",children:["\xbfNo posee una cuenta?"," ",(0,a.jsx)(o(),{className:"font-medium text-indigo-500",href:"/signup",children:"Registrarse"})]})]})})})}},3932:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let a=t(2651).A.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let r=localStorage.getItem("token");r&&(e.headers.Authorization="Bearer ".concat(r))}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>Promise.reject(e));let s=a},1455:(e,r,t)=>{"use strict";t.d(r,{R:()=>i,v:()=>u});var a=t(5155),s=t(2115),o=t(3932),l=t(2155),n=t(2615);let i=(0,s.createContext)({token:"",user:null,signInO:async()=>{throw Error("Not implemented")},signUp:async()=>{throw Error("Not implemented")},deleteUser:async()=>{throw Error("Not implemented")},mailIsValid:async()=>{throw Error("Not implemented")},updateUser:async()=>{throw Error("Not implemented")},signOut:async()=>{throw Error("Not implemented")},signInWithGoogle:async()=>{throw Error("Not implemented")},signUpWithGoogle:async()=>{throw Error("Not implemented")},requestResetPassword:async()=>{throw Error("Not implemented")},resetPassword:async()=>{throw Error("Not implemented")}}),u=e=>{let{children:r}=e,{data:t}=(0,n.useSession)(),[u,c]=(0,s.useState)(null),[d,m]=(0,s.useState)(""),[g,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(g)return;let e=localStorage.getItem("token"),r=localStorage.getItem("user");if(e&&m(e),r)try{c(JSON.parse(r))}catch(e){console.error("Error al parsear el usuario del localStorage",e)}if(null==t?void 0:t.user){let{email:e,name:r}=t.user;p(e,r)}},[t,g]);let p=(0,s.useCallback)(async(e,r)=>{try{let{data:t,error:a}=await (0,l.$)(o.A.get("users/email/get/".concat(e)));if(a)return console.warn("Error al consultar existencia del usuario:",a.message),null;if(null==t?void 0:t.data){let{data:r,error:t}=await (0,l.$)(o.A.get("/users/get/".concat(e)));if(t||!r)return console.log("Error al traer el usuario:",null==t?void 0:t.message),null;return c(r.data.User),m(r.data.token),localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data)),r.data}let{data:s,error:n}=await (0,l.$)(o.A.post("/users/crearUser/google",{email:e,name:r}));if(n||!s)return console.log("Error al crear el usuario:",null==n?void 0:n.message),null;return c(s.data),localStorage.setItem("user",JSON.stringify(s.data)),s.data}catch(e){return console.error("Error en el proceso de registro:",e),null}},[]),w=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,l.$)(o.A.post("/users/signIn",e));if(t||!r)throw Error(t.message||"Hubo un error al iniciar sesi\xf3n.");let{User:a,token:s}=(null==r?void 0:r.data)||{};if(!a||!s)throw Error("Los datos de autenticaci\xf3n son inv\xe1lidos.");return m(s),c(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[]),x=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,l.$)(o.A.post("/users/signUp",e));if(t||!r)throw Error(t.message||"Hubo un error al registrarse.");let{User:a,token:s}=r.data;return m(s),c(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[]),y=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,l.$)(o.A.delete("/users/user",{data:e}));if(t||!r)throw Error(t.message||"Hubo un error al eliminar el usuario.");let a=r.data;return m(""),c(null),localStorage.removeItem("token"),localStorage.removeItem("user"),a},[]),f=(0,s.useCallback)(async e=>{try{return(await o.A.get("/users/email/".concat(e))).data}catch(e){return!1}},[]),b=(0,s.useCallback)(async e=>{if(!(null==u?void 0:u.id))throw Error("El usuario no est\xe1 autenticado.");let{data:r,error:t}=await (0,l.$)(o.A.post("/users/update",{...e,id:u.id}));if(t||!r)throw Error(t.message||"Hubo un error al actualizar el usuario.");let{User:a,token:s}=r.data;return m(s),c(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[u]),N=(0,s.useCallback)(async()=>{await (0,n.signOut)({redirect:!1}),m(""),c(null),localStorage.removeItem("token"),localStorage.removeItem("user"),h(!0)},[]),v=(0,s.useCallback)(async()=>{try{await (0,n.signIn)("google",{callbackUrl:"/"});let e=await (0,n.getSession)();if(!e||!e.user)throw Error("No se pudo obtener la sesi\xf3n del usuario.");let{email:r,name:t}=e.user;return p(r,t)}catch(e){return console.error("Error en signInWithGoogle:",e),null}},[p]),E=(0,s.useCallback)(async()=>{try{await (0,n.signIn)("google",{callbackUrl:"/"});let e=await (0,n.getSession)();if(!e||!e.user)throw Error("No se pudo obtener la sesi\xf3n del usuario.");let{email:r,name:t}=e.user;return p(r,t)}catch(e){return console.error("Error en signUpWithGoogle:",e),null}},[p]),S=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,l.$)(o.A.post("/users/request-reset-password",{email:e}));if(t||!r)throw Error(t.message||"Error al solicitar reset de contrase\xf1a");return r.data},[]),k=(0,s.useCallback)(async(e,r)=>{let{data:t,error:a}=await (0,l.$)(o.A.post("/users/reset-password",{token:e,newPassword:r}));if(a||!t)throw Error(a.message||"Error al resetear la contrase\xf1a");return t.data},[]),j=(0,s.useMemo)(()=>({token:d,user:u,signInO:w,signUp:x,deleteUser:y,mailIsValid:f,updateUser:b,signOut:N,signInWithGoogle:v,signUpWithGoogle:E,requestResetPassword:S,resetPassword:k}),[d,u,w,x,y,f,b,N,v,E,S,k]);return(0,a.jsx)(i.Provider,{value:j,children:r})}},6046:(e,r,t)=>{"use strict";var a=t(6658);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},2155:(e,r,t)=>{"use strict";t.d(r,{$:()=>a});let a=async e=>{try{return{data:await e}}catch(e){return console.error("Error en handleAsync:",e),{error:e.response?e.response.data:{message:e.message}}}}}},e=>{var r=r=>e(e.s=r);e.O(0,[825,173,441,517,358],()=>r(2480)),_N_E=e.O()}]);