(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[470],{1820:(e,r,t)=>{Promise.resolve().then(t.bind(t,5584))},5584:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var a=t(5155),s=t(2115),o=t(6046),n=t(1455),l=t(8232);let i=()=>{let e=(0,o.useRouter)(),{user:r}=(0,s.useContext)(n.Rs),{sub:t}=(0,s.useContext)(l.h);return(0,a.jsx)("section",{className:"flex items-center justify-center min-h-screen p-4 bg-gray-900",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto text-center",children:[(0,a.jsxs)("h1",{className:"text-4xl md:text-5xl font-bold bg-clip-text text-transparent  bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 animate-[gradient_6s_linear_infinite]",children:["Gracias por suscribirte a ",null==t?void 0:t.plan.name]}),(0,a.jsx)("p",{className:"mt-6 text-xl text-indigo-200 md:text-2xl",children:"Su ambiente se est\xe1 creando. Esto puede demorar aproximadamente 48hs."}),(0,a.jsxs)("p",{className:"mt-4 text-lg text-indigo-200",children:["Recibir\xe1 los datos cuando se termine en ",(null==r?void 0:r.email)||"su correo","."]}),(0,a.jsx)("button",{onClick:()=>e.push("/"),className:"px-8 py-4 mt-8 text-white transition rounded-md bg-gradient-to-r from-purple-600 to-indigo-600 hover:opacity-90",children:"Volver al inicio"})]})})}},3932:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let a=t(2651).A.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let r=localStorage.getItem("token");r&&(e.headers.Authorization="Bearer ".concat(r))}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>Promise.reject(e));let s=a},8232:(e,r,t)=>{"use strict";t.d(r,{d:()=>c,h:()=>i});var a=t(5155),s=t(2115),o=t(3932),n=t(2155),l=t(1455);let i=(0,s.createContext)({sub:null,suscribirse:async()=>{},desuscribirse:async()=>!1,fetchSub:async()=>null}),c=e=>{let{children:r}=e,{user:t,signOut:c}=(0,s.useContext)(l.Ay),[u,d]=(0,s.useState)(null),m=async(e,r,t)=>{try{var a;let{data:s,error:l}=await (0,n.$)(o.A.post("/subscriptions",{planId:e,userEmail:t,paymentMethodToken:r}));if(l||!(null==s?void 0:null===(a=s.data)||void 0===a?void 0:a.subscription)){console.error("Error al suscribirse:",l||"No se retornaron datos");return}let i=s.data.subscription;d(i),localStorage.setItem("subscripcion",JSON.stringify(i))}catch(e){console.error("Excepci\xf3n en suscribirse:",e)}},g=async e=>{try{if(!u||!u.id)return console.error("No hay suscripci\xf3n activa para cancelar"),!1;let{data:r,error:t}=await (0,n.$)(o.A.post("/subscriptions/cancel",{subscriptionId:u.id,cancellationReason:e||"Cancelado por el usuario"}));if(t||!(null==r?void 0:r.data))return console.error("Error al cancelar la suscripci\xf3n:",t||"No se retornaron datos"),!1;let a=r.data.subscription;return d(a),a?localStorage.setItem("subscripcion",JSON.stringify(a)):localStorage.removeItem("subscripcion"),!0}catch(e){return console.error("Excepci\xf3n en desuscribirse:",e),!1}},p=async()=>{if(!t)return null;t.subscripcion&&d(t.subscripcion);let{data:e,error:r}=await (0,n.$)(o.A.get("/users/sub/".concat(t.id)));return!r&&(null==e?void 0:e.data)?(d(null==e?void 0:e.data),e.data):(console.log("Error al obtener la Subscripcion, error:",r||"No se retornaron datos"),null)};(0,s.useEffect)(()=>{t?p():(d(null),localStorage.removeItem("subscripcion"))},[t]);let h=(0,s.useMemo)(()=>({sub:u,suscribirse:m,desuscribirse:g,fetchSub:p}),[u,t]);return(0,a.jsx)(i.Provider,{value:h,children:r})}},1455:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>d,Rs:()=>c,vu:()=>u});var a=t(5155),s=t(2115),o=t(3932),n=t(2155),l=t(2615),i=t(9208);let c=(0,s.createContext)({token:"",user:null,signInO:async()=>{throw Error("Not implemented")},signUp:async()=>{throw Error("Not implemented")},deleteUser:async()=>{throw Error("Not implemented")},mailIsValid:async()=>{throw Error("Not implemented")},updateUser:async()=>{throw Error("Not implemented")},signOut:async()=>{throw Error("Not implemented")},signInWithGoogle:async()=>{throw Error("Not implemented")},signUpWithGoogle:async()=>{throw Error("Not implemented")},requestResetPassword:async()=>{throw Error("Not implemented")},resetPassword:async()=>{throw Error("Not implemented")}}),u=e=>{let{children:r}=e,{data:t}=(0,l.useSession)(),[u,d]=(0,s.useState)(null),[m,g]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{if(t&&t.user&&!u)try{let{email:e,name:r}=t.user;e&&r&&await p(e,r)}catch(e){console.error("Error al procesar la sesi\xf3n de Google:",e)}})()},[t]),(0,s.useEffect)(()=>{let e=localStorage.getItem("token")||i.A.get("token"),r=localStorage.getItem("user")||i.A.get("user");if(e&&g(e),r)try{d(JSON.parse(r))}catch(e){console.error("Error al parsear el usuario del localStorage o cookie",e)}},[]);let p=(0,s.useCallback)(async(e,r)=>{try{let{data:t,error:a}=await (0,n.$)(o.A.get("users/email/get/".concat(e)));if(a)return console.warn("Error al consultar existencia del usuario:",a.message),null;if(null==t?void 0:t.data){let{data:r,error:t}=await (0,n.$)(o.A.get("/users/get/".concat(e)));if(t||!r)return console.log("Error al traer el usuario:",null==t?void 0:t.message),null;return d(r.data.User),g(r.data.token),localStorage.setItem("token",r.data.token),localStorage.setItem("user",JSON.stringify(r.data.User)),i.A.set("token",r.data.token,{expires:7}),i.A.set("user",JSON.stringify(r.data.User),{expires:7}),r.data.User}let{data:s,error:l}=await (0,n.$)(o.A.post("/users/crearUser/google",{email:e,name:r}));if(l||!s)return console.log("Error al crear el usuario:",null==l?void 0:l.message),null;return d(s.data),localStorage.setItem("user",JSON.stringify(s.data)),i.A.set("user",JSON.stringify(s.data),{expires:7}),s.data}catch(e){return console.error("Error en el proceso de registro:",e),null}},[]),h=(0,s.useCallback)(async e=>{try{let{data:r,error:t}=await (0,n.$)(o.A.post("/users/signIn",e));if(t||!(null==r?void 0:r.data))throw Error((null==t?void 0:t.message)||"Error de inicio de sesi\xf3n");let{User:a,token:s}=r.data;return g(s),d(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),i.A.set("token",s,{expires:7}),i.A.set("user",JSON.stringify(a),{expires:7}),a}catch(e){return console.error("Error en signIn:",e),null}},[]),y=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,n.$)(o.A.post("/users/signUp",e));if(t||!(null==r?void 0:r.data))throw Error((null==t?void 0:t.message)||"Error de registro");let{User:a,token:s}=r.data;return g(s),d(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),i.A.set("token",s,{expires:7}),i.A.set("user",JSON.stringify(a),{expires:7}),a},[]),v=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,n.$)(o.A.delete("/users/user",{data:e}));if(t||!(null==r?void 0:r.data))throw Error((null==t?void 0:t.message)||"Error al eliminar usuario");let a=r.data;return g(""),d(null),localStorage.removeItem("token"),localStorage.removeItem("user"),i.A.remove("token"),i.A.remove("user"),a},[]),b=(0,s.useCallback)(async e=>{try{return(await o.A.get("/users/email/".concat(e))).data}catch(e){return!1}},[]),E=(0,s.useCallback)(async e=>{if(!(null==u?void 0:u.id))throw Error("Usuario no autenticado");let{data:r,error:t}=await (0,n.$)(o.A.put("/users/update/".concat(u.id),{...e}));if(t||!(null==r?void 0:r.data))throw Error((null==t?void 0:t.message)||"Error al actualizar usuario");let{User:a,token:s}=r.data;return a},[u]),f=(0,s.useCallback)(async()=>{try{await (0,l.signOut)({redirect:!1}),g(""),d(null),localStorage.removeItem("token"),localStorage.removeItem("user"),i.A.remove("token"),i.A.remove("user")}catch(e){console.error("Error durante el cierre de sesi\xf3n:",e)}},[]),x=(0,s.useCallback)(async()=>{try{return await (0,l.signIn)("google",{callbackUrl:"/"}),null}catch(e){return console.error("Error en signInWithGoogle:",e),null}},[]),w=(0,s.useCallback)(async()=>x(),[x]),k=(0,s.useCallback)(async e=>{let{data:r,error:t}=await (0,n.$)(o.A.post("/users/request-reset-password",{email:e}));if(t||!(null==r?void 0:r.data))throw Error((null==t?void 0:t.message)||"Error al solicitar reset de contrase\xf1a");return r.data},[]),S=(0,s.useCallback)(async(e,r)=>{let{data:t,error:a}=await (0,n.$)(o.A.post("/users/reset-password",{token:e,newPassword:r}));if(a||!(null==t?void 0:t.data))throw Error((null==a?void 0:a.message)||"Error al resetear contrase\xf1a");return t.data},[]),N=(0,s.useMemo)(()=>({token:m,user:u,signInO:h,signUp:y,deleteUser:v,mailIsValid:b,updateUser:E,signOut:f,signInWithGoogle:x,signUpWithGoogle:w,requestResetPassword:k,resetPassword:S}),[u,m,h,y,v,b,E,f,x,w,k,S]);return(0,a.jsx)(c.Provider,{value:N,children:r})},d=c},6046:(e,r,t)=>{"use strict";var a=t(6658);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})},2155:(e,r,t)=>{"use strict";t.d(r,{$:()=>a});let a=async e=>{try{return{data:await e}}catch(e){return console.error("Error en handleAsync:",e),{error:e.response?e.response.data:{message:e.message}}}}}},e=>{var r=r=>e(e.s=r);e.O(0,[651,633,441,517,358],()=>r(1820)),_N_E=e.O()}]);