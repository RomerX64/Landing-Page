"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[546],{2546:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var a=r(5155),s=r(1455),o=r(8173),l=r.n(o),n=r(6046),i=r(2115);function c(){let e;let[t,r]=(0,i.useState)({username:"",company:"",email:"",telefono:"",password:"",confirmPassword:""}),{signUp:o,mailIsValid:c,signUpWithGoogle:u,user:d}=(0,i.useContext)(s.R),[m,g]=(0,i.useState)(!1),[h,p]=(0,i.useState)(!1),[x,f]=(0,i.useState)(!1),[w,y]=(0,i.useState)(""),b=(0,n.useRouter)();d&&d&&b.push("/");let N=e=>{let{name:a,value:s}=e.target;if("telefono"===a){let e=s.replace(/\s+/g,"");e.startsWith("+54")||(e="+"+e.replace(/^\+?/,"")),g(!/^\+54[1-9]\d{1,14}$/.test(e)),r({...t,[a]:e})}else r({...t,[a]:s})},j=e=>{let{name:t,value:a}=e.target;r(e=>{let r={...e,[t]:a},s=r.password,o=r.confirmPassword;if(f(s.length<5),s.length>0&&o.length>0){let e=-1;for(let t=0;t<Math.min(s.length,o.length);t++)if(s[t]!==o[t]){e=t;break}-1===e?p(s.trimEnd()!==o.trimEnd()):p(!0)}else p(!1);return r})},k=async a=>{let s=a.target.value;r({...t,email:s}),clearTimeout(e),e=setTimeout(async()=>{await c(s)?y("Este correo ya est\xe1 registrado"):y("")},1e3)},E=async e=>{if(e.preventDefault(),!m&&!h&&!x&&!w)try{await o(t),console.log("Registro exitoso. Revise su email para confirmar.")}catch(e){console.error("Error en la solicitud:",e)}},S=async()=>{await u(),b.push("/")};return(0,a.jsx)("section",{children:(0,a.jsx)("div",{className:"max-w-6xl px-4 mx-auto sm:px-6",children:(0,a.jsxs)("div",{className:"py-12 md:py-20",children:[(0,a.jsx)("div",{className:"pb-12 text-center",children:(0,a.jsx)("h1",{className:"animate-[gradient_6s_linear_infinite] bg-[linear-gradient(to_right,theme(colors.gray.200),theme(colors.indigo.200),theme(colors.gray.50),theme(colors.indigo.300),theme(colors.gray.200))] bg-[length:200%_auto] bg-clip-text font-nacelle text-3xl font-semibold text-transparent md:text-4xl",children:"Crea tu usuario"})}),(0,a.jsxs)("form",{onSubmit:E,className:"mx-auto max-w-[400px]",children:[(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"username",className:"block mb-1 text-sm font-medium text-indigo-200/65",children:["Username ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"username",name:"username",type:"text",className:"w-full form-input",placeholder:"Su nombre de usuario",required:!0,onChange:N})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"company",className:"block mb-1 text-sm font-medium text-indigo-200/65",children:["Nombre de Compa\xf1\xeda ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"company",name:"company",type:"text",className:"w-full form-input",placeholder:"El nombre de su compa\xf1\xeda",required:!0,onChange:N})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"email",className:"block mb-1 text-sm font-medium text-indigo-200/65",children:["Work Email ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",className:"w-full form-input",placeholder:"Su email de trabajo",required:!0,value:t.email,onChange:k}),w&&(0,a.jsx)("span",{className:"text-xs text-red-500",children:w})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"telefono",className:"block mb-1 text-sm font-medium text-indigo-200/65",children:["N\xfamero Telef\xf3nico ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"telefono",name:"telefono",type:"tel",className:"w-full form-input",placeholder:"Su n\xfamero telef\xf3nico",required:!0,value:t.telefono,onChange:N}),m&&(0,a.jsx)("span",{className:"text-xs text-red-500",children:"Formato inv\xe1lido, debe tener el prefijo nacional"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"password",className:"block text-sm font-medium text-indigo-200/65",children:["Contrase\xf1a ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",className:"w-full form-input",placeholder:"Contrase\xf1a (m\xednimo 5 caracteres)",required:!0,onChange:j}),x&&(0,a.jsx)("span",{className:"text-xs text-red-500",children:"La contrase\xf1a debe tener al menos 5 caracteres"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-indigo-200/65",children:["Confirmar contrase\xf1a ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",className:"w-full form-input",placeholder:"Repita la contrase\xf1a",required:!0,onChange:j}),h&&!x&&(0,a.jsx)("span",{className:"text-xs text-red-500",children:"Las contrase\xf1as no son iguales"})]})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-5",children:[(0,a.jsx)("button",{type:"submit",className:"btn w-full bg-gradient-to-t from-indigo-600 to-indigo-500 text-white hover:bg-[length:100%_150%]",children:"Registrarse"}),(0,a.jsx)("button",{type:"button",onClick:S,className:"w-full text-gray-300 btn bg-gradient-to-b from-gray-800 to-gray-800/60",children:"Registrarse con Google"})]})]}),(0,a.jsxs)("div",{className:"mt-6 text-sm text-center text-indigo-200/65",children:["\xbfYa posee una cuenta?"," ",(0,a.jsx)(l(),{className:"font-medium text-indigo-500",href:"/signin",children:"Logearse"})]})]})})})}},3932:(e,t,r)=>{r.d(t,{A:()=>s});let a=r(2651).A.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>Promise.reject(e));let s=a},1455:(e,t,r)=>{r.d(t,{R:()=>i,v:()=>c});var a=r(5155),s=r(2115),o=r(3932),l=r(2155),n=r(2615);let i=(0,s.createContext)({token:"",user:null,signInO:async()=>{throw Error("Not implemented")},signUp:async()=>{throw Error("Not implemented")},deleteUser:async()=>{throw Error("Not implemented")},mailIsValid:async()=>{throw Error("Not implemented")},updateUser:async()=>{throw Error("Not implemented")},signOut:async()=>{throw Error("Not implemented")},signInWithGoogle:async()=>{throw Error("Not implemented")},signUpWithGoogle:async()=>{throw Error("Not implemented")},requestResetPassword:async()=>{throw Error("Not implemented")},resetPassword:async()=>{throw Error("Not implemented")}}),c=e=>{let{children:t}=e,{data:r}=(0,n.useSession)(),[c,u]=(0,s.useState)(null),[d,m]=(0,s.useState)(""),[g,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(g)return;let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&m(e),t)try{u(JSON.parse(t))}catch(e){console.error("Error al parsear el usuario del localStorage",e)}if(null==r?void 0:r.user){let{email:e,name:t}=r.user;p(e,t)}},[r,g]);let p=(0,s.useCallback)(async(e,t)=>{try{let{data:r,error:a}=await (0,l.$)(o.A.get("users/email/get/".concat(e)));if(a)return console.warn("Error al consultar existencia del usuario:",a.message),null;if(null==r?void 0:r.data){let{data:t,error:r}=await (0,l.$)(o.A.get("/users/get/".concat(e)));if(r||!t)return console.log("Error al traer el usuario:",null==r?void 0:r.message),null;return u(t.data.User),m(t.data.token),localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data)),t.data}let{data:s,error:n}=await (0,l.$)(o.A.post("/users/crearUser/google",{email:e,name:t}));if(n||!s)return console.log("Error al crear el usuario:",null==n?void 0:n.message),null;return u(s.data),localStorage.setItem("user",JSON.stringify(s.data)),s.data}catch(e){return console.error("Error en el proceso de registro:",e),null}},[]),x=(0,s.useCallback)(async e=>{let{data:t,error:r}=await (0,l.$)(o.A.post("/users/signIn",e));if(r||!t)throw Error(r.message||"Hubo un error al iniciar sesi\xf3n.");let{User:a,token:s}=(null==t?void 0:t.data)||{};if(!a||!s)throw Error("Los datos de autenticaci\xf3n son inv\xe1lidos.");return m(s),u(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[]),f=(0,s.useCallback)(async e=>{let{data:t,error:r}=await (0,l.$)(o.A.post("/users/signUp",e));if(r||!t)throw Error(r.message||"Hubo un error al registrarse.");let{User:a,token:s}=t.data;return m(s),u(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[]),w=(0,s.useCallback)(async e=>{let{data:t,error:r}=await (0,l.$)(o.A.delete("/users/user",{data:e}));if(r||!t)throw Error(r.message||"Hubo un error al eliminar el usuario.");let a=t.data;return m(""),u(null),localStorage.removeItem("token"),localStorage.removeItem("user"),a},[]),y=(0,s.useCallback)(async e=>{try{return(await o.A.get("/users/email/".concat(e))).data}catch(e){return!1}},[]),b=(0,s.useCallback)(async e=>{if(!(null==c?void 0:c.id))throw Error("El usuario no est\xe1 autenticado.");let{data:t,error:r}=await (0,l.$)(o.A.post("/users/update",{...e,id:c.id}));if(r||!t)throw Error(r.message||"Hubo un error al actualizar el usuario.");let{User:a,token:s}=t.data;return m(s),u(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},[c]),N=(0,s.useCallback)(async()=>{await (0,n.signOut)({redirect:!1}),m(""),u(null),localStorage.removeItem("token"),localStorage.removeItem("user"),h(!0)},[]),j=(0,s.useCallback)(async()=>{try{await (0,n.signIn)("google",{callbackUrl:"/"});let e=await (0,n.getSession)();if(!e||!e.user)throw Error("No se pudo obtener la sesi\xf3n del usuario.");let{email:t,name:r}=e.user;return p(t,r)}catch(e){return console.error("Error en signInWithGoogle:",e),null}},[p]),k=(0,s.useCallback)(async()=>{try{await (0,n.signIn)("google",{callbackUrl:"/"});let e=await (0,n.getSession)();if(!e||!e.user)throw Error("No se pudo obtener la sesi\xf3n del usuario.");let{email:t,name:r}=e.user;return p(t,r)}catch(e){return console.error("Error en signUpWithGoogle:",e),null}},[p]),E=(0,s.useCallback)(async e=>{let{data:t,error:r}=await (0,l.$)(o.A.post("/users/request-reset-password",{email:e}));if(r||!t)throw Error(r.message||"Error al solicitar reset de contrase\xf1a");return t.data},[]),S=(0,s.useCallback)(async(e,t)=>{let{data:r,error:a}=await (0,l.$)(o.A.post("/users/reset-password",{token:e,newPassword:t}));if(a||!r)throw Error(a.message||"Error al resetear la contrase\xf1a");return r.data},[]),v=(0,s.useMemo)(()=>({token:d,user:c,signInO:x,signUp:f,deleteUser:w,mailIsValid:y,updateUser:b,signOut:N,signInWithGoogle:j,signUpWithGoogle:k,requestResetPassword:E,resetPassword:S}),[d,c,x,f,w,y,b,N,j,k,E,S]);return(0,a.jsx)(i.Provider,{value:v,children:t})}},6046:(e,t,r)=>{var a=r(6658);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},2155:(e,t,r)=>{r.d(t,{$:()=>a});let a=async e=>{try{return{data:await e}}catch(e){return console.error("Error en handleAsync:",e),{error:e.response?e.response.data:{message:e.message}}}}}}]);