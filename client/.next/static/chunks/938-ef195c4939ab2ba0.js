"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{3938:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var a=r(5155),s=r(7013),l=r(8232),o=r(2115);let n=()=>{let{getUsers:e}=(0,o.useContext)(s.t),{planes:t}=(0,o.useContext)(l.a),[r,n]=(0,o.useState)([]),[i,c]=(0,o.useState)(""),[d,u]=(0,o.useState)([]),[g,m]=(0,o.useState)(null),[p,h]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(async()=>{try{let t=await e();n(t)}catch(e){console.error("Error fetching users:",e)}})()},[e]);let f=r.filter(e=>{let t=e.username.toLowerCase().includes(i.toLowerCase())||e.email.toLowerCase().includes(i.toLowerCase())||e.id.toLowerCase().includes(i.toLowerCase()),r=!0;return d.length>0&&(r=!!(e.subscripcion&&e.subscripcion.plan&&d.includes(e.subscripcion.plan.id))),t&&r}),S=e=>{d.includes(e)?u(t=>t.filter(t=>t!==e)):u(t=>[...t,e])},x=e=>{m(e),h(!0)};return(0,a.jsxs)("section",{className:"px-4 py-3 mx-auto max-w-7xl",children:[(0,a.jsx)("h1",{className:"mb-4 text-3xl font-bold",children:"Panel de Administraci\xf3n"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-6 md:flex-row",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar por username, email o ID...",value:i,onChange:e=>c(e.target.value),className:"flex-1 px-4 py-2 text-white bg-gray-700 rounded-lg"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-4",children:t.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>S(e.id),className:"px-4 py-2 rounded-lg text-white cursor-pointer transition-colors ".concat(d.includes(e.id)?"bg-indigo-600":"bg-gray-700"),children:e.name},e.id))})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:f.length>0?f.map(e=>(0,a.jsxs)("div",{onClick:()=>x(e),className:"p-4 transition-colors bg-gray-700 rounded-lg shadow cursor-pointer hover:bg-gray-600",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-white",children:e.username}),(0,a.jsx)("p",{className:"text-gray-300",children:e.email}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:["ID: ",e.id]})]},e.id)):(0,a.jsx)("div",{className:"text-center text-gray-300 col-span-full",children:"No se encontraron usuarios."})}),p&&g&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"w-11/12 p-6 bg-gray-800 rounded-lg shadow-lg md:w-1/2 lg:w-1/3",style:{transform:"scaleX(1.2) scaleY(1.1)",transformOrigin:"center"},children:[(0,a.jsx)("h2",{className:"mb-4 text-2xl font-bold text-white",children:"Detalles del Usuario"}),(0,a.jsx)("div",{className:"space-y-2 text-gray-300",children:Object.entries(g).filter(e=>{let[t]=e;return"password"!==t&&"isAdmin"!==t}).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("span",{className:"mr-2 font-bold",children:[t,":"]}),(0,a.jsx)("span",{children:"object"==typeof r?JSON.stringify(r):r})]},t)})}),(0,a.jsx)("button",{onClick:()=>{m(null),h(!1)},className:"px-4 py-2 mt-4 text-white transition-all rounded bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700",children:"Cerrar"})]})})]})}},3932:(e,t,r)=>{r.d(t,{A:()=>s});let a=r(2651).A.create({baseURL:"https://assetly-landing-page-backend.onrender.com",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e));let s=a},7013:(e,t,r)=>{r.d(t,{AdminProvider:()=>i,t:()=>n});var a=r(5155),s=r(2115),l=r(3932),o=r(2155);let n=(0,s.createContext)({getUsers:async()=>{throw Error("Not implemented")},getUsersSubscribed:async()=>{throw Error("Not implemented")},getUsersSubscribedAt:async e=>{throw Error("Not implemented")}}),i=e=>{let{children:t}=e,r=async()=>{let e=localStorage.getItem("admin_users");if(e)return console.log("Cargando usuarios desde localStorage..."),JSON.parse(e);let{data:t,error:r}=await (0,o.$)(l.A.get("/users/users"));if(r||!t||!t.data)throw Error("Error fetching users");return localStorage.setItem("admin_users",JSON.stringify(t.data)),t.data},s=async()=>{let e=localStorage.getItem("admin_usersSubscribed");if(e)return console.log("Cargando usuarios suscritos desde localStorage..."),JSON.parse(e);let{data:t,error:r}=await (0,o.$)(l.A.get("/users/getUsersSubscribed"));if(r||!t||!t.data)throw Error("Error fetching subscribed users");return localStorage.setItem("admin_usersSubscribed",JSON.stringify(t.data)),t.data},i=async e=>{let t="admin_usersSubscribed_plan_".concat(e),r=localStorage.getItem(t);if(r)return console.log("Cargando usuarios suscritos al plan ".concat(e," desde localStorage...")),JSON.parse(r);let{data:a,error:s}=await (0,o.$)(l.A.get("/users/getUsersSubscribed/".concat(e)));if(s||!a||!a.data)throw Error("Error fetching subscribed users at plan");return localStorage.setItem(t,JSON.stringify(a.data)),a.data};return(0,a.jsx)(n.Provider,{value:{getUsers:r,getUsersSubscribed:s,getUsersSubscribedAt:i},children:t})}},8232:(e,t,r)=>{r.d(t,{SuscribeProvider:()=>c,a:()=>i});var a=r(5155),s=r(2115),l=r(3932),o=r(2155),n=r(1455);let i=(0,s.createContext)({sub:null,planes:[],suscribirse:()=>{},desuscribirse:()=>{},selectPlan:async()=>null,viewPlan:null,changePlan:()=>{}}),c=e=>{let{children:t}=e,{user:r}=(0,s.useContext)(n.R),[c,d]=(0,s.useState)(null),[u,g]=(0,s.useState)([]),[m,p]=(0,s.useState)(null),h=async e=>{let{data:t,error:a}=await (0,o.$)(l.A.get("users/suscribe/".concat(null==r?void 0:r.id,"/").concat(e)));if(a||!t||!t.data){console.error("Error suscribi\xe9ndose:",a||"No data returned");return}d(t.data),localStorage.setItem("subscripcion",JSON.stringify(t.data))},f=async()=>{let{data:e,error:t}=await (0,o.$)(l.A.get("/users/desuscribe/".concat(null==r?void 0:r.id)));if(t||!e||!e.data){console.error("Error al desuscribirse:",t||"No data returned");return}d(null),localStorage.removeItem("subscripcion")},S=async()=>{let e=localStorage.getItem("planes");if(e){g(JSON.parse(e)),console.log("Planes Cargados");return}let{data:t,error:r}=await (0,o.$)(l.A.get("/users/planes"));if(r||!t||!t.data){console.error("Error al obtener los datos del plan:",r||"No data returned");return}let a=t.data;g(a),localStorage.setItem("planes",JSON.stringify(a))},x=async e=>{0===u.length&&await S();let t=u.find(t=>t.id===e);return t?(p(t),localStorage.setItem("viewPlan",JSON.stringify(t)),t):(console.error("Plan no encontrado"),null)};return(0,s.useEffect)(()=>{let e=localStorage.getItem("subscripcion");e&&d(JSON.parse(e)),S()},[r]),(0,s.useEffect)(()=>{if(u.length>0&&null===m){let e=localStorage.getItem("viewPlan");if(e)p(JSON.parse(e));else{let e=u.find(e=>!0===e.popular);e?p(e):p(u[0])}}},[u,m]),(0,a.jsx)(i.Provider,{value:{sub:c,planes:u,suscribirse:h,desuscribirse:f,selectPlan:x,viewPlan:m,changePlan:e=>{if(!m||0===u.length)return;let t=u.findIndex(e=>e.id===m.id);if(-1===t)return;let r="next"===e?t+1:t-1;r<0&&(r=u.length-1),r>=u.length&&(r=0);let a=u[r];p(a),localStorage.setItem("viewPlan",JSON.stringify(a))}},children:t})}},1455:(e,t,r)=>{r.d(t,{R:()=>n,UserProvider:()=>i});var a=r(5155),s=r(2115),l=r(3932),o=r(2155);let n=(0,s.createContext)({token:"",user:null,signIn:async()=>{throw Error("Not implemented")},signUp:async()=>{throw Error("Not implemented")},deleteUser:async()=>{throw Error("Not implemented")},mailIsValid:async()=>{throw Error("Not implemented")},setUser:()=>{},updateUser:async()=>{throw Error("Not implemented")}}),i=e=>{let{children:t}=e,[r,i]=(0,s.useState)(null),[c,d]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&d(e),t)try{i(JSON.parse(t))}catch(e){console.error("Error al parsear el usuario del localStorage",e)}},[]);let u=async e=>{console.log(e);let{data:t,error:r}=await (0,o.$)(l.A.post("/users/singIn",e));if(r||!t||!t.data)throw Error("No se recibi\xf3 respuesta de la API");let{User:a,token:s}=t.data;return d(s),i(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},g=async e=>{let{data:t,error:r}=await (0,o.$)(l.A.post("/users/singUp",e));if(r||!t||!t.data)throw Error("No se recibi\xf3 respuesta de la API");let{User:a,token:s}=t.data;return d(s),i(a),localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(a)),a},m=async e=>{let{data:t,error:r}=await (0,o.$)(l.A.delete("/users/user",{data:e}));if(r||!t||!t.data)throw Error("No se recibi\xf3 respuesta de la API");let a=t.data;return d(""),i(null),localStorage.removeItem("token"),localStorage.removeItem("user"),a},p=async e=>{try{let t=await l.A.get("/users/email/".concat(e));if(t.data||null===t.data||void 0===t.data)return!1;return t.data}catch(e){return!1}},h=async e=>{if(!(null==r?void 0:r.id))throw Error("El usuario no est\xe1 autenticado.");let{data:t,error:a}=await (0,o.$)(l.A.post("/users/update",{...e,id:r.id}));if(a||!t||!t.data)throw Error("No se recibi\xf3 respuesta de la API");let{User:s,token:n}=t.data;return d(n),i(s),localStorage.setItem("token",n),localStorage.setItem("user",JSON.stringify(s)),s};return(0,a.jsx)(n.Provider,{value:{token:c,user:r,setUser:i,signIn:u,signUp:g,deleteUser:m,mailIsValid:p,updateUser:h},children:t})}},2155:(e,t,r)=>{r.d(t,{$:()=>a});let a=async e=>{try{return{data:await e,error:null}}catch(e){return console.error(e),{data:null,error:e}}}}}]);