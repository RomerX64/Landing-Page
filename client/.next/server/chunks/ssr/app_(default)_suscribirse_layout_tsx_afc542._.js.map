{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/tomir/OneDrive/Desktop/AssetlyLandingPage/client/app/%28default%29/suscribirse/layout.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { SuscribeContext } from \"@/context/Suscribe.context\";\nimport { useRouter } from \"next/navigation\";\nimport { ChevronLeft } from \"lucide-react\";\nimport { initMercadoPago } from \"@mercadopago/sdk-react\";\n\nconst PaymentForm: React.FC = () => {\n  const { viewPlan, suscribirse } = useContext(SuscribeContext);\n  const router = useRouter();\n\n  const [cardNumber, setCardNumber] = useState(\"\");\n  const [cardHolder, setCardHolder] = useState(\"\");\n  const [expiryMonth, setExpiryMonth] = useState(\"\");\n  const [expiryYear, setExpiryYear] = useState(\"\");\n  const [cvv, setCvv] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  // Inicializamos el SDK con la public key de prueba\n  useEffect(() => {\n    initMercadoPago(\"TEST-450aba78-55dc-4623-9975-99be4b21f666\");\n  }, []);\n\n  // Función para generar el token real usando el SDK\n  const generateToken = async (): Promise<string> => {\n    const cardData = {\n      cardNumber: cardNumber.replace(/\\s/g, \"\"), // remover espacios si existieran\n      expirationMonth: expiryMonth,\n      expirationYear: expiryYear,\n      securityCode: cvv,\n      cardholderName: cardHolder,\n    };\n\n    const mp = (window as any).MercadoPago;\n    if (!mp || !mp.createCardToken) {\n      throw new Error(\"El SDK de Mercado Pago no se ha cargado correctamente.\");\n    }\n    const result = await mp.createCardToken(cardData);\n    if (result.status === 200) {\n      return result.response.id;\n    } else {\n      console.error(\"Error al generar token:\", result.response);\n      throw new Error(\"Error al generar token de tarjeta.\");\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setError(\"\");\n\n    if (!viewPlan) {\n      setError(\"No se ha seleccionado un plan.\");\n      return;\n    }\n    if (!cardNumber || !cardHolder || !expiryMonth || !expiryYear || !cvv) {\n      setError(\"Por favor, complete todos los campos de la tarjeta.\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // Genera el token real de la tarjeta usando el SDK de Mercado Pago\n      const paymentMethodToken = await generateToken();\n\n      // Llama a la función para suscribirse usando el token obtenido\n      await suscribirse(viewPlan.id, paymentMethodToken);\n\n      router.push(\"/suscribirse/success\");\n    } catch (err) {\n      console.error(\"Error en handleSubmit:\", err);\n      setError(\"Error al procesar el pago. Por favor, intente nuevamente.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <section className=\"max-w-3xl px-4 py-12 mx-auto\">\n      <div className=\"p-8 bg-gray-800 shadow-2xl rounded-2xl\">\n        <div className=\"flex items-center mb-6\">\n          <button\n            onClick={() => router.back()}\n            className=\"p-2 mr-4 text-white bg-gray-700 rounded-full hover:bg-gray-600\"\n          >\n            <ChevronLeft size={24} />\n          </button>\n          <h2 className=\"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400\">\n            Completa tu Pago\n          </h2>\n        </div>\n\n        {viewPlan && (\n          <div className=\"mb-6\">\n            <p className=\"text-gray-300\">\n              Estás suscribiéndote al plan{\" \"}\n              <span className=\"font-bold\">{viewPlan.name}</span> por{\" \"}\n              <span className=\"font-bold\">\n                ${viewPlan.precio} dólares mensuales\n              </span>\n              .\n            </p>\n          </div>\n        )}\n\n        {error && <p className=\"mb-4 text-red-500\">{error}</p>}\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label className=\"block text-gray-300\">Número de Tarjeta</label>\n            <input\n              type=\"text\"\n              value={cardNumber}\n              onChange={(e) => setCardNumber(e.target.value)}\n              placeholder=\"0000 0000 0000 0000\"\n              className=\"w-full p-3 mt-1 text-white bg-gray-700 rounded-lg focus:outline-none\"\n            />\n          </div>\n\n          <div>\n            <label className=\"block text-gray-300\">Nombre del Titular</label>\n            <input\n              type=\"text\"\n              value={cardHolder}\n              onChange={(e) => setCardHolder(e.target.value)}\n              placeholder=\"Nombre completo\"\n              className=\"w-full p-3 mt-1 text-white bg-gray-700 rounded-lg focus:outline-none\"\n            />\n          </div>\n\n          <div className=\"flex gap-4\">\n            <div className=\"flex-1\">\n              <label className=\"block text-gray-300\">Mes de Expiración</label>\n              <input\n                type=\"text\"\n                value={expiryMonth}\n                onChange={(e) => setExpiryMonth(e.target.value)}\n                placeholder=\"MM\"\n                className=\"w-full p-3 mt-1 text-white bg-gray-700 rounded-lg focus:outline-none\"\n              />\n            </div>\n            <div className=\"flex-1\">\n              <label className=\"block text-gray-300\">Año de Expiración</label>\n              <input\n                type=\"text\"\n                value={expiryYear}\n                onChange={(e) => setExpiryYear(e.target.value)}\n                placeholder=\"YYYY\"\n                className=\"w-full p-3 mt-1 text-white bg-gray-700 rounded-lg focus:outline-none\"\n              />\n            </div>\n            <div className=\"flex-1\">\n              <label className=\"block text-gray-300\">CVV</label>\n              <input\n                type=\"text\"\n                value={cvv}\n                onChange={(e) => setCvv(e.target.value)}\n                placeholder=\"123\"\n                className=\"w-full p-3 mt-1 text-white bg-gray-700 rounded-lg focus:outline-none\"\n              />\n            </div>\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full py-3 font-semibold text-white transition rounded-lg shadow-md bg-gradient-to-r from-purple-600 to-indigo-600 hover:opacity-90\"\n          >\n            {loading ? \"Procesando...\" : \"Confirmar Pago\"}\n          </button>\n        </form>\n      </div>\n    </section>\n  );\n};\n\nexport default PaymentForm;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 350, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}